<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1" targetNamespace="http://example.com/bpmn" exporter="Camunda Modeler" exporterVersion="5.40.1">
  <bpmn:process id="credit_check_agentic" name="Agentischer Kreditprüfungsprozess" isExecutable="true">
    <bpmn:startEvent id="StartEvent_CreditReceived" name="Kreditantrag erhalten">
      <bpmn:outgoing>Flow_1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_AI_Agent_Review" name="AI-Agent: Vorprüfung" camunda:type="external" camunda:topic="ai-agent-review">
      <bpmn:incoming>Flow_1</bpmn:incoming>
      <bpmn:outgoing>Flow_2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="Gateway_AI_Confident" name="AI sicher?">
      <bpmn:incoming>Flow_2</bpmn:incoming>
      <bpmn:outgoing>Flow_3_AI_Confident</bpmn:outgoing>
      <bpmn:outgoing>Flow_4_NeedsHumanReview</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:userTask id="Task_Human_Review" name="Manuelle Prüfung">
      <bpmn:incoming>Flow_4_NeedsHumanReview</bpmn:incoming>
      <bpmn:outgoing>Flow_5</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:businessRuleTask id="Task_DMN_Decision" name="Kreditentscheidung (DMN)" camunda:decisionRef="creditDecisionTable">
      <bpmn:incoming>Flow_3_AI_Confident</bpmn:incoming>
      <bpmn:incoming>Flow_5</bpmn:incoming>
      <bpmn:outgoing>Flow_6</bpmn:outgoing>
    </bpmn:businessRuleTask>
    <bpmn:endEvent id="EndEvent_Notify" name="Ergebnis kommuniziert">
      <bpmn:incoming>Flow_6</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow_1" sourceRef="StartEvent_CreditReceived" targetRef="Task_AI_Agent_Review" />
    <bpmn:sequenceFlow id="Flow_2" sourceRef="Task_AI_Agent_Review" targetRef="Gateway_AI_Confident" />
    <bpmn:sequenceFlow id="Flow_3_AI_Confident" sourceRef="Gateway_AI_Confident" targetRef="Task_DMN_Decision">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aiConfident == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_4_NeedsHumanReview" sourceRef="Gateway_AI_Confident" targetRef="Task_Human_Review">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${aiConfident == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="Flow_5" sourceRef="Task_Human_Review" targetRef="Task_DMN_Decision" />
    <bpmn:sequenceFlow id="Flow_6" sourceRef="Task_DMN_Decision" targetRef="EndEvent_Notify" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="credit_check_agentic">
      <bpmndi:BPMNShape id="Task_DMN_Decision_di" bpmnElement="Task_DMN_Decision">
        <dc:Bounds x="680" y="90" width="160" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_CreditReceived_di" bpmnElement="StartEvent_CreditReceived">
        <dc:Bounds x="172" y="115" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="160" y="151" width="60" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_AI_Agent_Review_di" bpmnElement="Task_AI_Agent_Review">
        <dc:Bounds x="300" y="90" width="120" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_Notify_di" bpmnElement="EndEvent_Notify">
        <dc:Bounds x="932" y="116" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="917" y="152" width="66" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_AI_Confident_di" bpmnElement="Gateway_AI_Confident" isMarkerVisible="true">
        <dc:Bounds x="525" y="105" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="525" y="81" width="49" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Human_Review_di" bpmnElement="Task_Human_Review">
        <dc:Bounds x="480" y="250" width="140" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="208" y="132" />
        <di:waypoint x="300" y="132" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="420" y="130" />
        <di:waypoint x="525" y="130" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_AI_Confident_di" bpmnElement="Flow_3_AI_Confident">
        <di:waypoint x="575" y="130" />
        <di:waypoint x="680" y="130" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_4_NeedsHumanReview_di" bpmnElement="Flow_4_NeedsHumanReview">
        <di:waypoint x="550" y="155" />
        <di:waypoint x="550" y="250" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_5_di" bpmnElement="Flow_5">
        <di:waypoint x="620" y="290" />
        <di:waypoint x="760" y="290" />
        <di:waypoint x="760" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_6_di" bpmnElement="Flow_6">
        <di:waypoint x="840" y="133" />
        <di:waypoint x="932" y="133" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
